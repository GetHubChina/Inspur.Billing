<UserControl x:Class="Inspur.Billing.View.Issue.InvalidCreditView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Inspur.Billing.View.Issue"
             mc:Ignorable="d" 
             xmlns:converter="clr-namespace:Inspur.Billing.Converter"
             DataContext="{Binding Path=InvalidCreditVm, Source={StaticResource Locator}}"
             d:DesignHeight="600" d:DesignWidth="800">
    <UserControl.Resources>
        <converter:TransactionTypeConverter x:Key="TransactionTypeConverter"/>
        <converter:TransactionTextConveter x:Key="TransactionTextConveter"/>
    </UserControl.Resources>
    <Border Background="White">
        <Grid Margin="10,20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Row="0" Grid.Column="0" Text="Issue Date:" Style="{StaticResource H_R_M10_ContentTbkStyle}" />
                <DatePicker Grid.Column="1" VerticalAlignment="Center" SelectedDate="{Binding IssueTime}" IsEnabled="{Binding IsBeginEnable}" Language="en-US" />
                <TextBlock Grid.Row="0" Grid.Column="2" Text="Invoice Code:" Style="{StaticResource H_R_M10_ContentTbkStyle}" />
                <TextBox Grid.Row="0" Grid.Column="3" Text="{Binding InvoiceCode}" Style="{StaticResource M_3_P_3_TbStyle}" VerticalAlignment="Center"/>
                <TextBlock Grid.Row="0" Grid.Column="4" Text="Invoice Number:" Style="{StaticResource H_R_M10_ContentTbkStyle}" />
                <TextBox Grid.Row="0" Grid.Column="5" Text="{Binding InvoiceNumber}" Style="{StaticResource M_3_P_3_TbStyle}" VerticalAlignment="Center"/>
            </Grid>
            <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,8">
                <Button Content="Query" Width="100" Grid.Row="1" Grid.Column="3" 
                        Command="{Binding CommonCommand}" CommandParameter="Query"/>
                <Button Content="Reset" Width="100" Grid.Row="1" Grid.Column="3" Margin="20,0,0,0" 
                        Command="{Binding CommonCommand}" CommandParameter="Reset"/>
            </StackPanel>
            <DataGrid Grid.Row="2" ItemsSource="{Binding InvoiceList}" SelectedItem="{Binding SelectedItem}"
                          Style="{StaticResource DataGridPrintStyle}" CanUserSortColumns="False">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="TAN" Binding="{Binding TPin}" ElementStyle="{StaticResource DataGridColumnLeft}" Width="*"/>
                    <DataGridTextColumn Header="Issue Date" Binding="{Binding IssueTime}" ElementStyle="{StaticResource DataGridColumnLeft}" Width="*"/>
                    <DataGridTextColumn Header="Taxpayer Name" Binding="{Binding TaxpayerName}" ElementStyle="{StaticResource DataGridColumnLeft}" Width="*"/>
                    <DataGridTextColumn Header="TerminalID" Binding="{Binding TerminalID}" Width="*"/>
                    <DataGridTextColumn Header="Invoice Code" Binding="{Binding InvoiceCode}" ElementStyle="{StaticResource DataGridColumnLeft}" Width="*"/>
                    <DataGridTextColumn Header="Invoice Number" Binding="{Binding InvoiceNumber}"
                                             ElementStyle="{StaticResource DataGridColumnLeft}" Width="*"/>
                    <DataGridTextColumn Header="Total Amount" Binding="{Binding TotalAmount,StringFormat={}{0:0.00}}" Width="90" IsReadOnly="True"
                                             ElementStyle="{StaticResource DataGridColumnRight}"/>
                    <DataGridTextColumn Header="Status" Binding="{Binding TransactionType,Converter={StaticResource TransactionTextConveter}}" Width="60" IsReadOnly="True"
                                             ElementStyle="{StaticResource DataGridColumnLeft}"/>
                    <DataGridTemplateColumn Header="Operation" Width="80">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <Button Content="Credit" Grid.Row="1" Grid.Column="3" 
                                            Command="{Binding DataContext.InvalidCommand,RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGrid}}"
                                            CommandParameter="Invalid">
                                        <Button.IsEnabled>
                                            <MultiBinding Converter="{StaticResource TransactionTypeConverter}">
                                                <Binding Path="TransactionType"/>
                                                <Binding Path="InvoiceCode"/>
                                            </MultiBinding>
                                        </Button.IsEnabled>
                                    </Button>
                                    <!--<Button Content="Detail" Grid.Row="1" Grid.Column="3" Margin="20,0,0,0" 
                                            Command="{Binding DataContext.InvalidCommand,RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=DataGrid}}"
                                            CommandParameter="Detail"/>-->
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
    </Border>
</UserControl>
